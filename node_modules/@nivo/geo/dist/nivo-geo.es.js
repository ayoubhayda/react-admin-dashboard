import{useMemo as e,memo as r,useCallback as o,Fragment as t,useRef as i,useEffect as n}from"react";import{useTheme as a,guessQuantizeColorScale as u,quantizeColorScalePropType as l,useDimensions as c,SvgWrapper as d,withContainer as s,ResponsiveWrapper as f,getRelativeCursor as h,bindDefs as p}from"@nivo/core";import{BasicTooltip as g,useTooltip as v}from"@nivo/tooltip";import m from"prop-types";import{useInheritedColor as C,inheritedColorPropType as b}from"@nivo/colors";import y from"lodash/isFunction";import R from"lodash/get";import{format as j}from"d3-format";import{geoAzimuthalEqualArea as q,geoAzimuthalEquidistant as T,geoGnomonic as M,geoOrthographic as W,geoStereographic as w,geoEqualEarth as k,geoEquirectangular as F,geoMercator as O,geoTransverseMercator as L,geoNaturalEarth1 as E,geoPath as S,geoGraticule as G,geoContains as x}from"d3-geo";import{useQuantizeColorScaleLegendData as B,BoxLegendSvg as P,renderLegendToCanvas as N}from"@nivo/legends";import{jsx as H}from"react/jsx-runtime";function I(){return I=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var o=arguments[r];for(var t in o)Object.prototype.hasOwnProperty.call(o,t)&&(e[t]=o[t])}return e},I.apply(this,arguments)}var D={azimuthalEqualArea:q,azimuthalEquidistant:T,gnomonic:M,orthographic:W,stereographic:w,equalEarth:k,equirectangular:F,mercator:O,transverseMercator:L,naturalEarth1:E},z=function(r){var o=r.width,t=r.height,i=r.projectionType,n=r.projectionScale,u=r.projectionTranslation,l=r.projectionRotation,c=r.fillColor,d=r.borderWidth,s=r.borderColor,f=e((function(){return D[i]().scale(n).translate([o*u[0],t*u[1]]).rotate(l)}),[o,t,i,n,u[0],u[1],l[0],l[1],l[2]]),h=e((function(){return S(f)}),[f]),p=e((function(){return G()})),g=a(),v=e((function(){return"function"==typeof d?d:function(){return d}}),[d]),m=C(s,g),b=e((function(){return"function"==typeof c?c:function(){return c}}),[c]);return{projection:f,path:h,graticule:p,getBorderWidth:v,getBorderColor:m,getFillColor:b}},K=function(r){var o=r.features,t=r.data,i=r.match,n=r.label,a=r.value,l=r.valueFormat,c=r.colors,d=r.unknownColor,s=r.domain,f=e((function(){return y(i)?i:function(e,r){var o=R(e,i),t=R(r,i);return o&&o===t}}),[i]),h=e((function(){return y(n)?n:function(e){return R(e,n)}}),[n]),p=e((function(){return y(a)?a:function(e){return R(e,a)}}),[a]),g=e((function(){return void 0===l?function(e){return e}:y(l)?l:j(l)}),[l]),v=e((function(){return u(c).domain(s)}),[c,s]),m=e((function(){return function(e){return void 0===e.value?d:v(e.value)}}),[v,d]),C=e((function(){return o.map((function(e){var r=t.find((function(r){return f(e,r)})),o=p(r);if(r){var i=I({},e,{data:r,value:o,formattedValue:g(o)});return i.color=m(i),i.label=h(i),i}return e}))}),[o,t,f,p,g,m]),b=B({scale:v,valueFormat:g});return{colorScale:v,getFillColor:m,boundFeatures:C,valueFormatter:g,legendData:b}},V=r((function(e){var r=e.feature;return void 0===r.data?null:H(g,{id:r.label,color:r.color,enableChip:!0,value:r.formattedValue})}));V.propTypes={feature:m.object.isRequired},V.displayName="ChoroplethTooltip";var A={features:m.arrayOf(m.shape({id:m.string.isRequired,type:m.oneOf(["Feature"]).isRequired,properties:m.object,geometry:m.object.isRequired})).isRequired,projectionType:m.oneOf(Object.keys(D)).isRequired,projectionScale:m.number.isRequired,projectionTranslation:m.arrayOf(m.number).isRequired,projectionRotation:m.arrayOf(m.number).isRequired,fillColor:m.oneOfType([m.string,m.func]).isRequired,borderWidth:m.oneOfType([m.number,m.func]).isRequired,borderColor:b.isRequired,enableGraticule:m.bool.isRequired,graticuleLineWidth:m.number.isRequired,graticuleLineColor:m.string.isRequired,isInteractive:m.bool.isRequired,onMouseEnter:m.func.isRequired,onMouseMove:m.func.isRequired,onMouseLeave:m.func.isRequired,onClick:m.func.isRequired,tooltip:m.any,layers:m.arrayOf(m.oneOfType([m.oneOf(["graticule","features"]),m.func])).isRequired},J=I({},A,{role:m.string.isRequired}),Q=I({pixelRatio:m.number.isRequired},A),U={data:m.arrayOf(m.object).isRequired,match:m.oneOfType([m.string,m.func]).isRequired,label:m.oneOfType([m.string,m.func]).isRequired,value:m.oneOfType([m.string,m.func]).isRequired,valueFormat:m.oneOfType([m.string,m.func]),colors:l.isRequired,domain:m.arrayOf(m.number).isRequired,unknownColor:m.string.isRequired,layers:m.arrayOf(m.oneOfType([m.oneOf(["graticule","features","legends"]),m.func])).isRequired},X=I({},J,U,{role:m.string.isRequired}),Y=I({},Q,U),Z={projectionType:"mercator",projectionScale:100,projectionTranslation:[.5,.5],projectionRotation:[0,0,0],enableGraticule:!1,graticuleLineWidth:.5,graticuleLineColor:"#999999",fillColor:"#dddddd",borderWidth:0,borderColor:"#000000",isInteractive:!0,onMouseEnter:function(){},onMouseLeave:function(){},onMouseMove:function(){},onClick:function(){},layers:["graticule","features"],legends:[],fill:[],defs:[]},$=I({},Z,{role:"img"}),_=I({},Z,{pixelRatio:"undefined"!=typeof window&&window.devicePixelRatio||1}),ee={match:"id",label:"id",value:"value",colors:"PuBuGn",unknownColor:"#999",tooltip:V,layers:["graticule","features","legends"]},re=I({},$,ee,{role:"img"}),oe=I({},_,ee),te=r((function(e){var r=e.path,o=e.graticule,t=e.lineWidth,i=e.lineColor;return H("path",{fill:"none",strokeWidth:t,stroke:i,d:r(o())})}));te.propTypes={path:m.func.isRequired,graticule:m.func.isRequired,lineWidth:m.number.isRequired,lineColor:m.string.isRequired},te.displayName="GeoGraticule";var ie=r((function(e){var r,o=e.feature,t=e.path,i=e.fillColor,n=e.borderWidth,a=e.borderColor,u=e.onClick,l=e.onMouseEnter,c=e.onMouseMove,d=e.onMouseLeave;return H("path",{fill:null!=(r=null==o?void 0:o.fill)?r:i,strokeWidth:n,stroke:a,strokeLinejoin:"bevel",d:t(o),onMouseEnter:function(e){return l(o,e)},onMouseMove:function(e){return c(o,e)},onMouseLeave:function(e){return d(o,e)},onClick:function(e){return u(o,e)}},o.id)}));ie.propTypes={feature:m.shape({id:m.string.isRequired,type:m.oneOf(["Feature"]).isRequired,properties:m.object,geometry:m.object.isRequired}).isRequired,path:m.func.isRequired,fillColor:m.string.isRequired,borderWidth:m.number.isRequired,borderColor:m.string.isRequired,onMouseEnter:m.func.isRequired,onMouseMove:m.func.isRequired,onMouseLeave:m.func.isRequired,onClick:m.func.isRequired},ie.displayName="GeoMapFeature";var ne=r((function(e){var r=e.width,i=e.height,n=e.margin,u=e.features,l=e.layers,s=e.projectionType,f=e.projectionScale,h=e.projectionTranslation,p=e.projectionRotation,g=e.fillColor,m=e.borderWidth,C=e.borderColor,b=e.enableGraticule,y=e.graticuleLineWidth,R=e.graticuleLineColor,j=e.isInteractive,q=e.onClick,T=e.tooltip,M=e.role,W=c(r,i,n),w=W.margin,k=W.outerWidth,F=W.outerHeight,O=z({width:r,height:i,projectionType:s,projectionScale:f,projectionTranslation:h,projectionRotation:p,fillColor:g,borderWidth:m,borderColor:C}),L=O.graticule,E=O.path,S=O.getFillColor,G=O.getBorderWidth,x=O.getBorderColor,B=a(),P=v(),N=P.showTooltipFromEvent,I=P.hideTooltip,D=o((function(e,r){return j&&q&&q(e,r)}),[j,q]),K=o((function(e,r){return j&&T&&N(H(T,{feature:e}),r)}),[j,N,T]),V=o((function(e,r){return j&&T&&N(H(T,{feature:e}),r)}),[j,N,T]),A=o((function(){return j&&I()}),[j,I]);return H(d,{width:k,height:F,margin:w,theme:B,role:M,children:l.map((function(r,o){return"graticule"===r?!0!==b?null:H(te,{path:E,graticule:L,lineWidth:y,lineColor:R},"graticule"):"features"===r?H(t,{children:u.map((function(e){return H(ie,{feature:e,path:E,fillColor:S(e),borderWidth:G(e),borderColor:x(e),onMouseEnter:K,onMouseMove:V,onMouseLeave:A,onClick:D},e.id)}))},"features"):H(t,{children:r(e)},o)}))})}));ne.displayName="GeoMap",ne.propTypes=J,ne.defaultProps=$;var ae=s(ne),ue=function(e){return H(f,{children:function(r){var o=r.width,t=r.height;return H(ae,I({width:o,height:t},e))}})},le=function(e,r,o,t){var i=h(r,e),n=i[0],a=i[1];return o.find((function(e){return x(e,t.invert([n,a]))}))},ce=r((function(e){var r=e.width,t=e.height,u=e.margin,l=e.pixelRatio,d=e.features,s=e.layers,f=e.projectionType,h=e.projectionScale,p=e.projectionTranslation,g=e.projectionRotation,m=e.fillColor,C=e.borderWidth,b=e.borderColor,y=e.enableGraticule,R=e.graticuleLineWidth,j=e.graticuleLineColor,q=e.isInteractive,T=e.onClick,M=e.onMouseMove,W=e.tooltip,w=i(null),k=a(),F=c(r,t,u),O=F.margin,L=F.outerWidth,E=F.outerHeight,S=z({width:r,height:t,projectionType:f,projectionScale:h,projectionTranslation:p,projectionRotation:g,fillColor:m,borderWidth:C,borderColor:b}),G=S.projection,x=S.graticule,B=S.path,P=S.getFillColor,N=S.getBorderWidth,I=S.getBorderColor;n((function(){if(w){w.current.width=L*l,w.current.height=E*l;var r=w.current.getContext("2d");r.scale(l,l),r.fillStyle=k.background,r.fillRect(0,0,L,E),r.translate(O.left,O.top),B.context(r),s.forEach((function(o){"graticule"===o?!0===y&&(r.lineWidth=R,r.strokeStyle=j,r.beginPath(),B(x()),r.stroke()):"features"===o?d.forEach((function(e){r.beginPath(),B(e),r.fillStyle=P(e),r.fill();var o=N(e);o>0&&(r.strokeStyle=I(e),r.lineWidth=o,r.stroke())})):o(r,e)}))}}),[w,L,E,O,l,k,B,x,P,N,I,d,s]);var D=v(),K=D.showTooltipFromEvent,V=D.hideTooltip,A=o((function(e){if(q&&W){var r=le(e,w.current,d,G);r?K(H(W,{feature:r}),e):V(),M&&M(r||null,e)}}),[K,V,q,W,w,d,G]),J=o((function(){return q&&V()}),[q,V]),Q=o((function(e){if(q&&T){var r=le(e,w.current,d,G);r&&T(r,e)}}),[q,w,d,G,T]);return H("canvas",{ref:w,width:L*l,height:E*l,style:{width:L,height:E,cursor:q?"auto":"normal"},onMouseMove:A,onMouseLeave:J,onClick:Q})}));ce.displatName="GeoMapCanvas",ce.propTypes=Q,ce.defaultProps=_;var de=s(ce),se=function(e){return H(f,{children:function(r){var o=r.width,t=r.height;return H(de,I({width:o,height:t},e))}})},fe=r((function(e){var r=e.width,i=e.height,n=e.margin,u=e.features,l=e.data,s=e.match,f=e.label,h=e.value,g=e.valueFormat,m=e.projectionType,C=e.projectionScale,b=e.projectionTranslation,y=e.projectionRotation,R=e.colors,j=e.domain,q=e.unknownColor,T=e.borderWidth,M=e.borderColor,W=e.enableGraticule,w=e.graticuleLineWidth,k=e.graticuleLineColor,F=e.layers,O=e.legends,L=e.isInteractive,E=e.onClick,S=e.tooltip,G=e.role,x=e.defs,B=void 0===x?re.defs:x,N=e.fill,D=void 0===N?re.fill:N,V=c(r,i,n),A=V.margin,J=V.outerWidth,Q=V.outerHeight,U=z({width:r,height:i,projectionType:m,projectionScale:C,projectionTranslation:b,projectionRotation:y,fillColor:function(){},borderWidth:T,borderColor:M}),X=U.graticule,Y=U.path,Z=U.getBorderWidth,$=U.getBorderColor,_=K({features:u,data:l,match:s,label:f,value:h,valueFormat:g,colors:R,unknownColor:q,domain:j}),ee=_.getFillColor,oe=_.boundFeatures,ne=_.legendData,ae=a(),ue=p(B,oe,D,{dataKey:"data",targetKey:"fill"}),le=v(),ce=le.showTooltipFromEvent,de=le.hideTooltip,se=o((function(e,r){return L&&E&&E(e,r)}),[L,E]),fe=o((function(e,r){return L&&S&&ce(H(S,{feature:e}),r)}),[L,ce,S]),he=o((function(e,r){return L&&S&&ce(H(S,{feature:e}),r)}),[L,ce,S]),pe=o((function(){return L&&de()}),[L,de]);return H(d,{width:J,height:Q,margin:A,theme:ae,defs:ue,role:G,children:F.map((function(e,o){return"graticule"===e?!0!==W?null:H(te,{path:Y,graticule:X,lineWidth:w,lineColor:k},"graticule"):"features"===e?H(t,{children:oe.map((function(e){return H(ie,{feature:e,path:Y,fillColor:ee(e),borderWidth:Z(e),borderColor:$(e),onMouseEnter:fe,onMouseMove:he,onMouseLeave:pe,onClick:se},e.id)}))},"features"):"legends"===e?O.map((function(e,o){return H(P,I({containerWidth:r,containerHeight:i,data:ne},e),o)})):H(t,{children:e({})},o)}))})}));fe.displayName="Choropleth",fe.propTypes=X,fe.defaultProps=re;var he=s(fe),pe=function(e){return H(f,{children:function(r){var o=r.width,t=r.height;return H(he,I({width:o,height:t},e))}})},ge=function(e,r,o,t){var i=h(r,e),n=i[0],a=i[1];return o.find((function(e){return x(e,t.invert([n,a]))}))},ve=r((function(e){var r=e.width,t=e.height,u=e.margin,l=e.pixelRatio,d=e.features,s=e.data,f=e.match,h=e.label,p=e.value,g=e.valueFormat,m=e.projectionType,C=e.projectionScale,b=e.projectionTranslation,y=e.projectionRotation,R=e.colors,j=e.domain,q=e.unknownColor,T=e.borderWidth,M=e.borderColor,W=e.enableGraticule,w=e.graticuleLineWidth,k=e.graticuleLineColor,F=e.layers,O=e.legends,L=e.isInteractive,E=e.onClick,S=e.onMouseMove,G=e.tooltip,x=i(null),B=a(),P=c(r,t,u),D=P.margin,V=P.outerWidth,A=P.outerHeight,J=z({width:r,height:t,projectionType:m,projectionScale:C,projectionTranslation:b,projectionRotation:y,fillColor:function(){},borderWidth:T,borderColor:M}),Q=J.projection,U=J.graticule,X=J.path,Y=J.getBorderWidth,Z=J.getBorderColor,$=K({features:d,data:s,match:f,label:h,value:p,valueFormat:g,colors:R,unknownColor:q,domain:j}),_=$.getFillColor,ee=$.boundFeatures,re=$.legendData;n((function(){if(x){x.current.width=V*l,x.current.height=A*l;var e=x.current.getContext("2d");e.scale(l,l),e.fillStyle=B.background,e.fillRect(0,0,V,A),e.translate(D.left,D.top),X.context(e),F.forEach((function(o){"graticule"===o?!0===W&&(e.lineWidth=w,e.strokeStyle=k,e.beginPath(),X(U()),e.stroke()):"features"===o?ee.forEach((function(r){e.beginPath(),X(r),e.fillStyle=_(r),e.fill();var o=Y(r);o>0&&(e.strokeStyle=Z(r),e.lineWidth=o,e.stroke())})):"legends"===o&&O.forEach((function(o){N(e,I({},o,{data:re,containerWidth:r,containerHeight:t,theme:B}))}))}))}}),[x,V,A,D,l,B,X,U,_,Y,Z,ee,O,F]);var oe=v(),te=oe.showTooltipFromEvent,ie=oe.hideTooltip,ne=o((function(e){if(L&&G){var r=ge(e,x.current,ee,Q);r?te(H(G,{feature:r}),e):ie(),S&&S(r||null,e)}}),[te,ie,L,G,x,ee,Q]),ae=o((function(){return L&&ie()}),[L,ie]),ue=o((function(e){if(L&&E){var r=ge(e,x.current,ee,Q);r&&E(r,e)}}),[L,x,ee,Q,E]);return H("canvas",{ref:x,width:V*l,height:A*l,style:{width:V,height:A,cursor:L?"auto":"normal"},onMouseMove:ne,onMouseLeave:ae,onClick:ue})}));ve.displayName="ChoroplethCanvas",ve.propTypes=Y,ve.defaultProps=oe;var me=s(ve),Ce=function(e){return H(f,{children:function(r){var o=r.width,t=r.height;return H(me,I({width:o,height:t},e))}})};export{he as Choropleth,me as ChoroplethCanvas,oe as ChoroplethCanvasDefaultProps,Y as ChoroplethCanvasPropTypes,re as ChoroplethDefaultProps,X as ChoroplethPropTypes,ae as GeoMap,de as GeoMapCanvas,_ as GeoMapCanvasDefaultProps,Q as GeoMapCanvasPropTypes,$ as GeoMapDefaultProps,J as GeoMapPropTypes,pe as ResponsiveChoropleth,Ce as ResponsiveChoroplethCanvas,ue as ResponsiveGeoMap,se as ResponsiveGeoMapCanvas,D as projectionById,K as useChoropleth,z as useGeoMap};
//# sourceMappingURL=nivo-geo.es.js.map
